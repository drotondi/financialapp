<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mis Activos e Inversiones</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --card: #1f2937;
      --accent: #10b981;
      --accent-2: #60a5fa;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    * { box-sizing: border-box; }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      margin: 0;
      background: radial-gradient(circle at 10% 20%, rgba(96,165,250,0.12), transparent 25%),
                  radial-gradient(circle at 90% 10%, rgba(16,185,129,0.12), transparent 20%),
                  linear-gradient(180deg, #0b1220 0%, #0f172a 60%);
      color: var(--text);
      min-height: 100vh;
    }

    header {
      padding: 24px 20px 8px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .title {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .title h1 {
      margin: 0;
      font-size: 28px;
      letter-spacing: -0.5px;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--accent);
      background: rgba(16, 185, 129, 0.12);
      border: 1px solid rgba(16,185,129,0.2);
    }

    .grid {
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 20px 32px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 16px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 16px 18px 18px;
    }

    .card h2 {
      margin: 0 0 12px;
      font-size: 18px;
    }

    .muted { color: var(--muted); }

    label { display: block; margin-bottom: 6px; font-size: 14px; }
    input, textarea, select {
      width: 100%;
      padding: 10px 12px;
      background: #0f172a;
      border: 1px solid #1f2937;
      border-radius: 10px;
      color: var(--text);
      font-size: 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent-2);
      box-shadow: 0 0 0 3px rgba(96,165,250,0.2);
    }

    button {
      cursor: pointer;
      border: none;
      border-radius: 10px;
      padding: 12px 14px;
      font-weight: 600;
      color: #0b1220;
      background: linear-gradient(90deg, #34d399, #10b981);
      transition: transform 0.1s ease, box-shadow 0.2s ease;
      box-shadow: 0 10px 20px rgba(16,185,129,0.25);
      width: 100%;
    }

    button:hover { transform: translateY(-1px); }
    button:active { transform: translateY(0); }

    .secondary-btn {
      background: #111827;
      color: var(--text);
      border: 1px solid #1f2937;
      box-shadow: none;
    }

    .flex-row { display: flex; gap: 10px; }

    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
      font-size: 14px;
    }

    .table th, .table td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #1f2937;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(96,165,250,0.14);
      color: #dbeafe;
      border-radius: 999px;
      font-size: 12px;
    }

    .totals {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
    }

    .badge {
      display: inline-block;
      background: rgba(16,185,129,0.14);
      color: #c3f8e6;
      padding: 6px 10px;
      border-radius: 10px;
      font-size: 12px;
      border: 1px solid rgba(16,185,129,0.25);
    }

    @media (max-width: 720px) {
      header { padding: 18px 16px 0; }
      .grid { padding: 8px 16px 24px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="title">
      <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--accent);"></div>
      <h1>Panel de activos e inversiones</h1>
      <span class="pill">100% HTML + localStorage</span>
    </div>
    <p class="muted" style="margin: 6px 0 14px; max-width: 720px;">
      Guarda un inventario rápido de tus bienes y posiciones financieras directamente en tu navegador. Los datos viven en <strong>localStorage</strong> del dispositivo y puedes borrarlos en cualquier momento.
    </p>
    <div class="totals">
      <div class="card">
        <div class="muted" style="font-size: 13px;">Total activos</div>
        <div style="font-size: 26px; font-weight: 700;" id="total-assets">$0.00</div>
        <div class="badge" id="count-assets">0 registros</div>
      </div>
      <div class="card">
        <div class="muted" style="font-size: 13px;">Total inversiones</div>
        <div style="font-size: 26px; font-weight: 700;" id="total-investments">$0.00</div>
        <div class="badge" id="count-investments">0 registros</div>
      </div>
      <div class="card">
        <div class="muted" style="font-size: 13px;">Acciones rápidas</div>
        <div class="flex-row">
          <button class="secondary-btn" id="export-data" type="button">Exportar JSON</button>
          <button class="secondary-btn" id="clear-data" type="button" style="color: #fca5a5; border-color: #b91c1c;">Borrar datos</button>
        </div>
      </div>
    </div>
  </header>

  <main class="grid">
    <section class="card">
      <h2>Registrar activo</h2>
      <form id="asset-form">
        <label for="asset-name">Nombre</label>
        <input id="asset-name" name="name" placeholder="Apartamento, auto, ahorro" required>

        <label for="asset-category">Categoría</label>
        <input id="asset-category" name="category" placeholder="Inmueble, vehículo, efectivo" required>

        <label for="asset-value">Valor</label>
        <input id="asset-value" name="value" type="number" step="0.01" min="0" placeholder="50000" required>

        <label for="asset-currency">Divisa</label>
        <input id="asset-currency" name="currency" placeholder="USD, EUR, MXN" value="USD">

        <label for="asset-date">Fecha de adquisición</label>
        <input id="asset-date" name="acquired_on" type="date">

        <button type="submit" style="margin-top: 10px;">Agregar activo</button>
      </form>
    </section>

    <section class="card">
      <h2>Registrar inversión</h2>
      <form id="investment-form">
        <label for="inv-name">Nombre</label>
        <input id="inv-name" name="name" placeholder="ETF S&P 500, BTC, bono" required>

        <label for="inv-class">Clase de activo</label>
        <input id="inv-class" name="asset_class" placeholder="Acciones, cripto, renta fija" required>

        <label for="inv-amount">Monto invertido</label>
        <input id="inv-amount" name="amount" type="number" step="0.01" min="0" placeholder="1200" required>

        <label for="inv-currency">Divisa</label>
        <input id="inv-currency" name="currency" placeholder="USD, EUR, MXN" value="USD">

        <label for="inv-date">Fecha de inversión</label>
        <input id="inv-date" name="invested_on" type="date">

        <label for="inv-notes">Notas</label>
        <textarea id="inv-notes" name="notes" rows="2" placeholder="Broker, ticket, horizonte, etc."></textarea>

        <button type="submit" style="margin-top: 10px;">Agregar inversión</button>
      </form>
    </section>

    <section class="card" style="grid-column: 1 / -1;">
      <div style="display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
        <h2 style="margin: 0;">Listado</h2>
        <div class="muted" style="font-size: 13px;">Los totales se calculan en la divisa ingresada; no se aplican cambios de moneda.</div>
      </div>
      <div class="flex-row" style="margin-top: 10px; flex-wrap: wrap;">
        <div class="tag">Activos</div>
        <div class="tag" style="background: rgba(16,185,129,0.15); color: #d1fae5;">Inversiones</div>
      </div>
      <div style="overflow-x: auto; margin-top: 10px;">
        <table class="table" id="records-table">
          <thead>
            <tr>
              <th>Tipo</th>
              <th>Nombre</th>
              <th>Detalle</th>
              <th>Valor</th>
              <th>Divisa</th>
              <th>Fecha</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

  <script>
    const assetForm = document.getElementById('asset-form');
    const investmentForm = document.getElementById('investment-form');
    const tableBody = document.querySelector('#records-table tbody');
    const totalAssetsEl = document.getElementById('total-assets');
    const totalInvestmentsEl = document.getElementById('total-investments');
    const countAssetsEl = document.getElementById('count-assets');
    const countInvestmentsEl = document.getElementById('count-investments');
    const exportBtn = document.getElementById('export-data');
    const clearBtn = document.getElementById('clear-data');

    const currencyFormat = (value) => new Intl.NumberFormat('es-ES', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2,
    }).format(value || 0);

    const loadData = () => {
      const assets = JSON.parse(localStorage.getItem('assets') || '[]');
      const investments = JSON.parse(localStorage.getItem('investments') || '[]');
      return { assets, investments };
    };

    const saveData = (assets, investments) => {
      localStorage.setItem('assets', JSON.stringify(assets));
      localStorage.setItem('investments', JSON.stringify(investments));
    };

    const render = () => {
      const { assets, investments } = loadData();
      tableBody.innerHTML = '';

      const rows = [
        ...assets.map((item, index) => ({ type: 'Activo', ...item, index })),
        ...investments.map((item, index) => ({ type: 'Inversión', ...item, index })),
      ];

      rows.forEach((row) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${row.type}</td>
          <td>${row.name}</td>
          <td>${row.category || row.asset_class || ''} ${row.notes ? `<div class="muted" style="font-size:12px;">${row.notes}</div>` : ''}</td>
          <td>$${currencyFormat(row.value || row.amount)}</td>
          <td>${row.currency || 'USD'}</td>
          <td>${row.acquired_on || row.invested_on || ''}</td>
          <td><button class="secondary-btn" data-type="${row.type}" data-index="${row.index}">Eliminar</button></td>
        `;
        tableBody.appendChild(tr);
      });

      const totalAssets = assets.reduce((acc, item) => acc + Number(item.value || 0), 0);
      const totalInvestments = investments.reduce((acc, item) => acc + Number(item.amount || 0), 0);

      totalAssetsEl.textContent = `$${currencyFormat(totalAssets)}`;
      totalInvestmentsEl.textContent = `$${currencyFormat(totalInvestments)}`;
      countAssetsEl.textContent = `${assets.length} registros`;
      countInvestmentsEl.textContent = `${investments.length} registros`;
    };

    assetForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(assetForm);
      const newAsset = {
        name: formData.get('name').trim(),
        category: formData.get('category').trim(),
        value: Number(formData.get('value')),
        currency: formData.get('currency').trim() || 'USD',
        acquired_on: formData.get('acquired_on'),
      };

      if (!newAsset.name || !newAsset.category || Number.isNaN(newAsset.value)) return;

      const { assets, investments } = loadData();
      assets.unshift(newAsset);
      saveData(assets, investments);
      assetForm.reset();
      render();
    });

    investmentForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(investmentForm);
      const newInvestment = {
        name: formData.get('name').trim(),
        asset_class: formData.get('asset_class').trim(),
        amount: Number(formData.get('amount')),
        currency: formData.get('currency').trim() || 'USD',
        invested_on: formData.get('invested_on'),
        notes: formData.get('notes').trim(),
      };

      if (!newInvestment.name || !newInvestment.asset_class || Number.isNaN(newInvestment.amount)) return;

      const { assets, investments } = loadData();
      investments.unshift(newInvestment);
      saveData(assets, investments);
      investmentForm.reset();
      render();
    });

    tableBody.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-type]');
      if (!btn) return;
      const { assets, investments } = loadData();
      const index = Number(btn.dataset.index);
      if (btn.dataset.type === 'Activo') {
        assets.splice(index, 1);
      } else {
        investments.splice(index, 1);
      }
      saveData(assets, investments);
      render();
    });

    exportBtn.addEventListener('click', () => {
      const data = loadData();
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'finanzas.json';
      link.click();
      URL.revokeObjectURL(url);
    });

    clearBtn.addEventListener('click', () => {
      const confirmed = confirm('¿Seguro que deseas borrar todos los registros locales?');
      if (!confirmed) return;
      saveData([], []);
      render();
    });

    render();
  </script>
</body>
</html>
